<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cori</title>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Noto+Sans+SC:wght@700&display=swap" rel="stylesheet">
    <style>
      * { box-sizing: border-box; }
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        min-height: 100vh;
        color: #111111;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        position: relative;
        overflow-x: hidden;
        
        /* ROBUST GRADIENT BACKGROUND */
        background-color: #ffffff;
        background-image: 
            radial-gradient(at 0% 0%, rgba(224, 242, 254, 0.8) 0px, transparent 50%),
            radial-gradient(at 100% 100%, rgba(243, 232, 255, 0.8) 0px, transparent 50%),
            radial-gradient(at 100% 0%, rgba(224, 242, 254, 0.5) 0px, transparent 50%);
        background-attachment: fixed;
      }

      /* Shooting Stars (Corrected: Top-Left to Bottom-Right) */
      .night {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        pointer-events: none;
        overflow: hidden;
      }

      .shooting_star {
        position: absolute;
        top: 0;
        left: 0;
        height: 2px;
        width: 180px; /* Longer tail */
        /* Flip gradient: Tail (Transparent) -> Head (Color) */
        background: linear-gradient(90deg, transparent, #6366f1);
        border-radius: 999px;
        opacity: 0;
        /* Rotate to point down-right */
        transform: rotate(45deg) translateX(0);
        animation: meteor 6s linear infinite;
      }
      
      @keyframes meteor {
        0% {
          opacity: 0;
          /* Start: Top-Left (off screen) */
          transform: rotate(45deg) translateX(-200px);
        }
        10% {
          opacity: 1;
        }
        80% {
          opacity: 1;
        }
        100% {
          opacity: 0;
          /* End: Bottom-Right (far away) */
          transform: rotate(45deg) translateX(150vw);
        }
      }
      
      /* Random Positioning (Distributed) */
      .shooting_star:nth-child(1) { top: -100px; left: 10%; animation-delay: 0s; }
      .shooting_star:nth-child(2) { top: -100px; left: 40%; animation-delay: 2s; }
      .shooting_star:nth-child(3) { top: -100px; left: 70%; animation-delay: 4s; }
      .shooting_star:nth-child(4) { top: 20%; left: -200px; animation-delay: 1.5s; } /* Side entry */
      .shooting_star:nth-child(5) { top: 50%; left: -200px; animation-delay: 3.5s; }
      .shooting_star:nth-child(6) { top: -100px; left: 90%; animation-delay: 5s; }

      /* Content Container */
      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        width: 100%;
        padding: 40px 20px;
        position: relative;
        z-index: 1;
      }
      .avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 4px solid #111;
        margin-bottom: 5px;
        transition: transform 0.5s ease;
      }
      .avatar:hover {
        transform: rotateY(180deg);
      }
      .name {
        font-family: 'Pacifico', cursive;
        font-size: 72px;
        color: transparent;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        background-clip: text;
        margin: 0 0 5px 0;
        letter-spacing: 4px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      }
      .tagline {
        font-size: 14px;
        color: #666;
        margin: 0 0 40px 0;
        letter-spacing: 1px;
      }
      .nav {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        width: 100%;
      }
      .nav-btn {
        display: inline-block;
        padding: 14px 36px;
        background: #111;
        color: #fff;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        border-radius: 50px;
        transition: all 0.2s ease;
      }
      .nav-btn:hover {
        background: #444;
        transform: translateY(-2px);
      }
      .widget {
        position: fixed;
        right: 20px;
        bottom: 20px;
        background: #111;
        color: #fff;
        padding: 10px 18px;
        border-radius: 20px;
        font-size: 12px;
        cursor: pointer;
        z-index: 1000;
      }
      .modal-backdrop {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.8);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }
      .modal-card {
        background: #fff;
        padding: 30px 40px;
        border-radius: 8px;
        text-align: center;
        max-width: 500px;
        width: 90%;
      }
      .modal-title {
        font-size: 20px;
        font-weight: 600;
        color: #111;
        margin: 0 0 20px 0;
      }
      .modal-desc {
        color: #666;
        line-height: 1.6;
        margin: 0;
      }
    </style>
</head>
<body>
    <div class="night">
        <div class="shooting_star"></div>
        <div class="shooting_star"></div>
        <div class="shooting_star"></div>
        <div class="shooting_star"></div>
        <div class="shooting_star"></div>
        <div class="shooting_star"></div>
    </div>
    <!-- Aurora removed, handled by body background -->
    <div class="container">
        <img src="/assets/img/avatar.jpg" class="avatar" alt="Cori">
        <h1 class="name">Cori</h1>
        <p class="tagline">伴你同行，让记忆有根，思想有文</p>
        <div class="nav">
            <a href="https://openclaw.cori.tokyo/blog" class="nav-btn">博客</a>
            <a href="https://openclaw.cori.tokyo/book/" class="nav-btn">书库</a>
            <a href="https://openclaw.cori.tokyo/models/" class="nav-btn">模型</a>
            <a href="https://openclaw.cori.tokyo/reading/" class="nav-btn">阅读</a>
        </div>
    </div>
    
            <div id="cnyStatsInside" style="margin-top: 15px; font-size: 13px; color: #333; display: flex; justify-content: space-around; padding: 0 10px; border-top: 1px solid #eee; padding-top: 15px;">
                <!-- Stats inside modal -->
            </div>
        </div>
    </div>
    
    <script>
        function closeCnyModal(){document.getElementById('cnyModal').style.display='none';}

        function renderCnyModal(){
            const el = document.getElementById('cnyModalChart');
            const statsEl = document.getElementById('cnyStatsInside');
            
            // Show loading state
            el.innerHTML = '<div style="display:flex;height:100%;align-items:center;justify-content:center;color:#999;">加载中...</div>';
            
            fetch('https://openclaw.cori.tokyo/data/cnyjpy.json?t='+Date.now())
            .then(r=>r.json())
            .then(d=>{
                // 1. 数据处理：保留原始 JPY/CNY 值 (例如 0.044)
                let pts=(d.points||[]).map(p=>{
                    let v=p.v;
                    if(v>1) v=1/v; // 如果是 22.5 (CNY/JPY)，转为 0.044 (JPY/CNY)
                    return {t:p.t, v:v};
                }).filter(p=>p.v>0.03 && p.v<0.07); // 过滤异常值
                
                const uniq=new Map();
                pts.forEach(p=>{
                    const dt=new Date(p.t<10000000000?p.t*1000:p.t);
                    uniq.set(dt.getMonth()+1+'/'+dt.getDate(), p);
                });
                const fp=Array.from(uniq.values()).slice(-14);
                
                if(fp.length<2){
                    el.innerHTML='<div style="display:flex;height:100%;align-items:center;justify-content:center;color:#999;">暂无图表数据</div>';
                    if(statsEl) statsEl.innerHTML='数据不足';
                    return;
                }
                
                // 2. 统计数据计算 (for modal)
                const vs=fp.map(p=>p.v);
                const currentVal = fp[fp.length - 1].v;
                const maxVal = Math.max(...vs);
                const minVal = Math.min(...vs);

                if(statsEl) {
                    const statsHTML = `
                        <div>当前: <strong style="color:#3b82f6; font-size: 14px;">${currentVal.toFixed(4)}</strong></div>
                        <div>最高: <strong style="color:#10b981; font-size: 14px;">${maxVal.toFixed(4)}</strong></div>
                        <div>最低: <strong style="color:#ef4444; font-size: 14px;">${minVal.toFixed(4)}</strong></div>
                    `;
                    statsEl.innerHTML = statsHTML;
                }
                
                // 3. 图表配置
                const w=500, h=250;
                const padTop=20, padBottom=30, padLeft=45, padRight=20; // Increased left padding for axis labels
                const chartW = w - padLeft - padRight;
                const chartH = h - padTop - padBottom;
                
                // 4. 计算极值
                let mn=minVal, mx=maxVal;
                const range = mx - mn;
                // Add padding to range
                mn = mn - range * 0.1;
                mx = mx + range * 0.1;
                
                // 5. 坐标转换函数
                const getX = (i) => padLeft + i * (chartW / (fp.length - 1));
                const getY = (v) => h - padBottom - ((v - mn) / (mx - mn)) * chartH;
                
                // 6. 生成路径
                let pthD = '';
                let areaD = '';
                let pointsSVG = '';
                let labelsSVG = '';
                let gridSVG = '';
                
                // Y轴网格线 (3条)
                [mn, mn + (mx-mn)/2, mx].forEach(val => {
                    const y = getY(val);
                    if (!isNaN(y)) {
                        gridSVG += `<line x1="${padLeft}" y1="${y}" x2="${w-padRight}" y2="${y}" stroke="#eee" stroke-dasharray="4"/>`;
                        labelsSVG += `<text x="${padLeft-5}" y="${y+4}" font-size="10" fill="#999" text-anchor="end">${val.toFixed(4)}</text>`;
                    }
                });
                
                fp.forEach((p, i) => {
                    const x = getX(i);
                    const y = getY(p.v);
                    
                    if (i === 0) {
                        pthD += `M${x},${y}`;
                        areaD += `M${x},${h-padBottom} L${x},${y}`;
                    } else {
                        pthD += `L${x},${y}`;
                        areaD += `L${x},${y}`;
                    }
                    
                    // 最后一个点闭合区域
                    if (i === fp.length - 1) {
                        areaD += `L${x},${h-padBottom} Z`;
                    }
                    
                    // 数据点 (空心圆)
                    pointsSVG += `<circle cx="${x}" cy="${y}" r="4" fill="#fff" stroke="#3b82f6" stroke-width="2"/>`;
                    
                    // X轴日期标签 (每隔2个显示)
                    if (i % 2 === 0 || i === fp.length - 1) {
                        const date = new Date(p.t<10000000000?p.t*1000:p.t);
                        const dateStr = (date.getMonth()+1) + '/' + date.getDate();
                        labelsSVG += `<text x="${x}" y="${h-10}" font-size="10" fill="#999" text-anchor="middle">${dateStr}</text>`;
                    }
                });
                
                // 7. 渲染SVG
                el.innerHTML = `
                <svg viewBox="0 0 ${w} ${h}" style="width:100%;height:100%;">
                    <!-- 背景网格 -->
                    ${gridSVG}
                    <!-- 区域填充 -->
                    <path d="${areaD}" fill="rgba(59, 130, 246, 0.1)" stroke="none"/>
                    <!-- 折线 -->
                    <path d="${pthD}" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <!-- 数据点 -->
                    ${pointsSVG}
                    <!-- 标签 -->
                    ${labelsSVG}
                </svg>`;
                
            }).catch(e=>{
                console.error(e);
                el.innerHTML='<div style="display:flex;height:100%;align-items:center;justify-content:center;color:#999;">加载失败</div>';
                if(statsEl) statsEl.innerHTML='数据加载失败';
            });
        }
    </script>
</body>
</html>

